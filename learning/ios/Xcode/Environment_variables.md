# Environment variables

Нужны для динамической конфигурации приложения. Например, подстановки защищенных данных в рантайме. На проекте со скринов ниже переменные окружения использовались в качестве конфигураторов для возможности подстановки моков.
Представляет из себя сет элементов вида ключ-значение. Советуется использовать их как read-only свойства.

_Важно знать про ограничение, что за работу с переменными окружения отвечает сам Xcode, поэтому, если приложение было установлено из AppStore/TestFlight, переменные окружения использованы не будут._

## Как добавить в проект

1. Заходим в редактирование схемы
![edit-scheme](https://user-images.githubusercontent.com/41479045/165668509-30301882-cea9-47a3-8090-99f29a2dada6.png)
2. Переходим во вкладку "Test" - "Arguments"
![env-args](https://user-images.githubusercontent.com/41479045/165668830-7acc0e9e-4f72-4fd6-bbe9-af97c2d68029.png)
3. Пример добавления "считывателей" переменных окружения по ключам. [ProcessInfo - набор информации о текущем процессе](https://developer.apple.com/documentation/foundation/processinfo)
![vars-reading](https://user-images.githubusercontent.com/41479045/165668898-6540b174-4db9-4302-b946-c338dff00381.png)
4. Пример использования. Так как в данном конкретном случае есть enum MockInfo, то используем считанные значения как булевый параметр
![usage-example](https://user-images.githubusercontent.com/41479045/165668963-61057ba7-13b8-484a-b36a-16132506a6e7.png)


## Предопределенные переменные окружения
В Xcode есть несколько предопределенных переменных, доступных для целей отладки.
Например:
* NSZombieEnabled - определяет, будет Foundation использовать зомби-объекты в рантайме. Должно помогать в отладке непонятного поведения, вызванного зомби-объектами. [Можно читнуть ссылку на эту тему](https://gist.github.com/JeOam/e62c95a0b4c21974bcf6)
* NSDeallocateZombies: определяет, должен ли Foundation освобождать все зомби-объекты.
* MallocGuardEdges: включает защиту памяти до и после буфера, чтобы мы могли отлавливать переполнения буфера.

[Интересная статья, которая может пояснить что такое зомби-объект](https://habr.com/ru/company/hh/blog/546856/)

Некоторые предопределенные переменные окружния можно настраивать через вкладку Diagnostics
![default-env-vars](https://user-images.githubusercontent.com/41479045/165672941-20555722-7499-4da3-9358-5a4f590b1d4d.png)
