<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-onboarding docs-doc-id-project-inside">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-91G2XYQTXS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-91G2XYQTXS",{})</script><title data-rh="true">Устройство типового проекта | Kotlin Multiplatform Mobile</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kmm.icerock.dev/onboarding/project-inside"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-onboarding-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-onboarding-current"><meta data-rh="true" property="og:title" content="Устройство типового проекта | Kotlin Multiplatform Mobile"><meta data-rh="true" name="description" content="Вводная"><meta data-rh="true" property="og:description" content="Вводная"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kmm.icerock.dev/onboarding/project-inside"><link data-rh="true" rel="alternate" href="https://kmm.icerock.dev/onboarding/project-inside" hreflang="en"><link data-rh="true" rel="alternate" href="https://kmm.icerock.dev/onboarding/project-inside" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.893f3d2c.css">
<link rel="preload" href="/assets/js/runtime~main.a0e172f5.js" as="script">
<link rel="preload" href="/assets/js/main.c6cd5e7a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/onboarding/intro">Onboarding</a><a class="navbar__item navbar__link" href="/learning/intro">Knowledge Base</a><a class="navbar__item navbar__link" href="/university/intro">University</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/icerockdev/kmm.icerock.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/intro">О разделе</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/getting-started">Знакомство с KMM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/project-setup">Запуск проекта</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/onboarding/project-inside">Устройство типового проекта</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/gradle">Gradle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/moko">MOKO библиотеки</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/kmm-details">Особенности KMM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/ios-specific">Для iOS разработчиков</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/android-specific">Для Android разработчиков</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/generate-localized-strings">Генерация строк локализации</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/onboarding/conclusion">Заключение</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Устройство типового проекта</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Устройство типового проекта</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="вводная">Вводная<a class="hash-link" href="#вводная" title="Direct link to heading">​</a></h2><p>В данной статье разобран типовой KMM проект на базе <a href="https://gitlab.icerockdev.com/scl/boilerplate/mobile-moko-boilerplate" target="_blank" rel="noopener noreferrer">mobile-moko-boilerplate</a>. Внимание уделено каждому файлу и директории в проекте, дано пояснение ко всему - для чего используется, в каких случаях нужно вносить изменения, как работает.</p><p>После ознакомления с материалом вы узнаете:</p><ol><li>Из каких частей состоит проект</li><li>Где находится конфигурация мультиплатформенного модуля</li><li>Как реализована интеграция мультиплатформенного модуля в iOS</li><li>Какие настройки применены к текущему проекту для мультиплатформенного модуля</li><li>Как устроена многомодульность на проекте</li><li>Как объявляются внешние зависимости (библиотеки)</li><li>Как настроен экспорт зависимостей в iOS фреймворк</li><li>Как реализован DI (Dependency Injection)</li><li>Как реализована навигация на android и iOS </li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="конфигурация-сборки">Конфигурация сборки<a class="hash-link" href="#конфигурация-сборки" title="Direct link to heading">​</a></h2><p>Проект хранится в моно-репозитории, то есть в одном репозитории содержится и android и ios приложения, а также общая библиотека на Kotlin Multiplatform.</p><p>Проект использует несколько систем сборки:</p><ol><li><a href="https://gradle.org/" target="_blank" rel="noopener noreferrer">Gradle</a> - система сборки для Android приложения и Kotlin библиотеки;</li><li><a href="https://developer.apple.com/xcode/" target="_blank" rel="noopener noreferrer">Xcode</a> - система сборки (и IDE) для iOS приложения.</li></ol><p>Давайте разберемся с тем, как происходит сборка обеих платформ.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="сборка-android-приложения">Сборка Android приложения<a class="hash-link" href="#сборка-android-приложения" title="Direct link to heading">​</a></h3><p>Для сборки Android приложения нам достаточно Gradle системы сборки.</p><p>Когда мы нажимаем на кнопку Run в Android Studio по сути мы запускаем gradle задачу <code>assembleDevDebug</code> в gradle-проекте <code>android-app</code>. Это можно увидеть по логу, который отображается во вкладке <code>Build</code> при запуске.</p><p><img loading="lazy" alt="android studio build task" src="/assets/images/android-studio-build-task-a8e01a3b8e8c1e93530cc4f6aeb1ab7f.png" width="1684" height="445" class="img_E7b_"></p><p>Задача <code>assembleDevDebug</code> производит компиляцию только Debug типа сборки и только Dev <a href="https://developer.android.com/studio/build/build-variants" target="_blank" rel="noopener noreferrer">product flavour</a>. Для выполнения этой задачи требуется выполнить множество других задач, от которых данная задача зависит. Поэтому в логе сборки мы видим выполнение множества задач. При компиляции android приложения будет автоматически скомпилирован и модуль с общим Kotlin Multiplatform кодом (gradle проект <code>mpp-library</code>). Это происходит потому, что в <code>android-app</code> указана зависимость на проект <code>mpp-library</code> (будет разобрано подробнее позже).</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="сборка-ios-приложения">Сборка iOS приложения<a class="hash-link" href="#сборка-ios-приложения" title="Direct link to heading">​</a></h3><p>Для сборки iOS приложения используются сразу обе системы - Xcode и Gradle, что, разумеется, увеличивает время сборки. Это также осложняет и анализ ошибок сборки, ведь ошибки могут быть как в разных системах сборки по отдельности, так и на стыке двух систем.</p><p>Когда мы нажимаем на кнопку Run в Xcode, начинается процесс сборки как и у любого другого iOS приложения через сам Xcode. Наш Xcode проект имеет зависимость на CocoaPod <code>MultiPlatformLibrary</code>, поэтому при компиляции приложения начнется и компиляция <code>MultiPlatformLibrary</code>.</p><p>Узнать подробнее о том, как происходит компиляция этой зависимости и подключение сторонних подов, вы можете в <a href="/learning/ios/pods">разделе обучения</a>.</p><p>После того, как локальный под будет скомпилирован, а все остальные зависимости &quot;подцеплены&quot; нашим приложением, произойдет запуск.  </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="структура-проекта">Структура проекта<a class="hash-link" href="#структура-проекта" title="Direct link to heading">​</a></h2><p>Ознакомимся с содержимым в корне репозитория. </p><p><code>ls -lp</code>:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">build-logic/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">android-app/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ios-app/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mpp-library/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gradle/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">build.gradle.kts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gradle.properties</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gradlew</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gradlew.bat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings.gradle.kts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">README.md</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Кратко про каждый элемент, для понимания общей картины:</p><ul><li><code>android-app/</code> - директория с исходным кодом Android приложения;</li><li><code>ios-app/</code> - директория с исходным кодом iOS приложения;</li><li><code>build-logic/</code> - директория с логикой для системы сборки Gradle;</li><li><code>mpp-library/</code> - директория с исходным кодом общей библиотеки на KMM;</li><li><code>gradle/</code> - специальная директория системы сборки Gradle, в которой лежит Gradle Wrapper;</li><li><code>build.gradle.kts</code> - файл конфигурации сборки корневого gradle проекта;</li><li><code>gradle.properties</code> - файл с опциями, которые передаются в Gradle проект при запуске;</li><li><code>gradlew</code> и <code>gradlew.bat</code> - скрипты для Unix и Windows соответственно, которые запускают Gradle используя Gradle Wrapper;</li><li><code>settings.gradle.kts</code> - файл настроек Gradle проекта;</li><li><code>README.md</code> - краткое описание содержимого репозитория и инструкция как собирать проект.</li></ul><p>Далее разберем все блоки более детально.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="root-gradle-project">Root Gradle project<a class="hash-link" href="#root-gradle-project" title="Direct link to heading">​</a></h2><p>Следующая важная составляющая нашего проекта - корневой gradle проект. Как было сказано ранее - для сборки обеих платформ используется gradle. Для android только он, а для ios gradle является одной из билдсистем. Корневая директория нашего проекта по сути и является корневым gradle проектом. <code>android-app</code> и <code>mpp-library</code> подключаются к этому коревому проекту как подпроекты.</p><p>К коревому gradle проекту относятся:</p><ul><li><code>build-logic</code> - <a href="/learning/gradle/composite-build">композитно</a> подключенный проект, несущий в себе логику сборки остальных подпроектов;</li><li><code>gradle.properties</code> - опции запуска gradle проекта;</li><li><code>settings.gradle.kts</code> - файл настроек;</li><li><code>build.gradle.kts</code> - файл конфигурации сборки.</li><li><code>gradle</code> - директория <a href="/learning/gradle/gradle-wrapper">Gradle Wrapper&#x27;а</a> - специального скрипта, который автоматизирует процесс установки нужной версии gradle.</li></ul><p>О том как обновить версию Gradle в проекте вы можете прочитать в <a href="/learning/gradle/updating-versions">специальном разделе обучения</a>. </p><p>Больше файлов относящихся непосредственно к коревому gradle проекту в репозитории нет.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="buildsrc-устарело-но-бывает-на-проектах"><a href="/learning/gradle/buildSrc">buildSrc</a> (устарело, но бывает на проектах)<a class="hash-link" href="#buildsrc-устарело-но-бывает-на-проектах" title="Direct link to heading">​</a></h3><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Директория упразднена! </p><p>На новых проектах вместо <code>buildSrc</code> используется <code>Composite build</code>.</p></div></div><p><code>buildSrc</code> - <a href="https://docs.gradle.org/current/userguide/organizing_gradle_projects.html#sec:build_sources" target="_blank" rel="noopener noreferrer">специальная директория Gradle</a>. Она предназначена для реализации логики сборки, не привязанной к конкретному gradle модулю. По сути это исходники библиотеки, которая автоматически будет подгружена в gradle и все классы объявленные в этой библиотеке будут доступны в любом месте Gradle конфигурации (в <code>build.gradle.kts</code>).</p><p>В этой директории можно увидеть собственный <code>build.gradle.kts</code> и исходный код библиотеки. <code>build.gradle.kts</code> определяет как будет собираться данная библиотека и какие зависимости ей требуются. Исходный код библиотеки в нашем проекте содержит только один объект <code>Deps</code>, содержащий константы и зависимости, необходимые нашему проекту.</p><p>В <code>build.gradle.kts</code> можно увидеть подключение нескольких зависимостей:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(&quot;dev.icerock:mobile-multiplatform:0.9.2&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.4.32&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(&quot;com.android.tools.build:gradle:4.1.3&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В <code>Deps.kt</code> объявлен объект <code>Deps</code> с перечислением версий зависимостей и самих зависимостей в виде констант, для удобного обращения к ним в gradle конфигурации.</p><p>Ниже приведено пояснение ко всем составляющим данного объекта:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">object Deps {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // в начале перечисляются константами версии каждой из использующихся зависимостей. </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // они приватные, так как используются данные константы только внутри самого Deps</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private const val materialVersion = &quot;1.2.1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // во вложенном объекте Android описываются версии используемых android sdk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    object Android {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        const val compileSdk = 30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        const val targetSdk = 30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        const val minSdk = 21</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // во вложенном объекте Plugins содержатся объявления каждого используемого нами gradle плагина,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // в специальном контейнере GradlePlugin (данный класс приходит от зависимости mobile-multiplatform-gradle-plugin)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // https://github.com/icerockdev/mobile-multiplatform-gradle-plugin/blob/master/src/main/kotlin/GradlePlugin.kt#L10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    object Plugins {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // мы можем объявить gradle плагин используя только id, в таком случае будет недоступно</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // подключение артефакта с данным плагином (для этого нужно указание свойства module)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // такой подход используется для плагинов, которые подключаются с gradlePluginPortal, либо</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // содержатся в зависимостях, которые указаны в buildSrc/build.gradle.kts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        val androidApplication = GradlePlugin(id = &quot;com.android.application&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // для плагинов, которые требуют подключения дополнительных артефактов нужно указать свойство</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // module и в build.gradle.kts подключить в buildscript.dependencies</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        val kotlinSerialization = GradlePlugin(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            id = &quot;org.jetbrains.kotlin.plugin.serialization&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            module = &quot;org.jetbrains.kotlin:kotlin-serialization:$kotlinxSerializationPluginVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // вложенный объект Libs содержит объявления каждой внешней библиотеки</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    object Libs {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // в Android содержатся библиотеки относящиеся только к android, используются в android-app </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // либо как зависимости androidMain sourceSet&#x27;а</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        object Android {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // объявление зависимости происходит в виде обычной строки</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            const val appCompat = &quot;androidx.appcompat:appcompat:$androidAppCompatVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // в Tests указываются зависимости для тестов в android-app либо androidTest sourceSet&#x27;а</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            object Tests {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // объявление также происходит в виде обычной строки</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                const val espressoCore = &quot;androidx.test.espresso:espresso-core:$espressoCoreVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // в MultiPlatform объекте содержатся объявления всех мультиплатформенных библиотек</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // используется в mpp-library и вложенных в нее модулях</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        object MultiPlatform {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // те зависимости, которые не предполагается использовать в Kotlin/Native export, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // указываются в виде простой строки. Указывается артефакт метаданных, по которому </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // gradle найдет все артефакты для нужных таргетов  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            const val kotlinSerialization = </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;org.jetbrains.kotlinx:kotlinx-serialization-core:$kotlinxSerializationVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // те зависимости, которые будут экспортироваться в iOS framework, объявляются в виде</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // MultiPlatformLibrary контейнера (из mobile-multiplatform-gradle-plugin)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // https://github.com/icerockdev/mobile-multiplatform-gradle-plugin/blob/master/src/main/kotlin/MultiPlatformLibrary.kt#L10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // для простоты чаще всего используется преобразование из строки с путем до артефакта </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // метаданных, через метод defaultMPL, с указанием в аргументах тех таргетов, которые </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // нужно автоматически заполнить (заполнение идет согласно именованию стандартной </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // публикации мультиплатформенных библиотек) </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            val mokoResources = &quot;dev.icerock.moko:resources:$mokoResourcesVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .defaultMPL(ios = true)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // в Tests указываются зависимости для тестов в mpp-library и вложенных модулях</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            object Tests {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // зависимости указываются в виде строк</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                const val kotlinTest = &quot;org.jetbrains.kotlin:kotlin-test-common:$kotlinTestVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // в Detekt указываются специфичные для detekt плагина зависимости</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        object Detekt {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // зависимости указываются в виде строк</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            const val detektFormatting = &quot;io.gitlab.arturbosch.detekt:detekt-formatting:$detektVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // в Modules указываются gradle модули нашего проекта</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    object Modules {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        object Feature {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // объявляются модули в виде контейнера MultiPlatformModule (из mobile-multiplatform-gradle-plugin)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // https://github.com/icerockdev/mobile-multiplatform-gradle-plugin/blob/master/src/main/kotlin/MultiPlatformModule.kt#L10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // в name указывается путь до gradle проекта, а в exported флаг нужно ли экспортировать </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // классы данного модуля в iOS framework</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            val auth = MultiPlatformModule(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name = &quot;:mpp-library:feature:auth&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exported = true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Данный класс определяет константы, которые мы будем использовать в <code>build.gradle.kts</code> всех gradle модулей, что сокращает вероятность ошибки и позволяет менять версии/пути до библиотек в одном месте.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="version-catalogs">Version Catalogs<a class="hash-link" href="#version-catalogs" title="Direct link to heading">​</a></h3><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Объект <code>Deps</code> заменен на <code>Version Catalog</code>!</p></div></div><p>На новых проектах внутри директории <code>gradle</code> есть файл <code>libs.versions.toml</code>. Это список зависимостей, на основе которого gradle сгенерирует специальные свойства для доступа к зависимостям по именам со строгими типами, данный файл позволяет централизованно управлять зависимостями всего проекта.</p><p>Давайте посмотрим на этот файл:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># версии </span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">versions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">materialVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.4.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">recyclerViewVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.2.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">swipeRefreshLayoutVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.1.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">constraintLayoutVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2.0.4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2.3.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glideVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;4.12.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hiltVersion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2.35&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># библиотеки с ссылками на версии</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">libraries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">material </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;com.google.android.material:material&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;materialVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">recyclerView </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.recyclerview:recyclerview&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;recyclerViewVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">swipeRefreshLayout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.swiperefreshlayout:swiperefreshlayout&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;swipeRefreshLayoutVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">constraintLayout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.constraintlayout:constraintlayout&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;constraintLayoutVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glide </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;com.github.bumptech.glide:glide&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;glideVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleViewModel </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleLivedata </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-livedata-ktx&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleRuntime </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-runtime-ktx&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleViewModelSavedState </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-viewmodel-savedstate&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleCommonJava8 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-common-java8&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleServices </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-service&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleProcess </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-process&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lifecycleReactiveStreams </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;androidx.lifecycle:lifecycle-reactivestreams-ktx&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lifecycleVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hilt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;com.google.dagger:hilt-android&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hiltVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hiltCompiler </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> module </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;com.google.dagger:hilt-android-compiler&quot;</span><span class="token plain">, version.ref </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hiltVersion&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ...</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это фича пришла с вместе с Gradle 7.0. Активация этой фичи происходит в файле <code>settings.gradle.kts</code>:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">enableFeaturePreview(&quot;VERSION_CATALOGS&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Больше информации о Version Catalogs можете найти <a href="/learning/gradle/version-catalogs">тут</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Для сравнения можете посмотреть файл <code>Deps.kt</code> из директории <code>buildSrc/</code>, о которой мы говорили выше.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="build-logic">build-logic<a class="hash-link" href="#build-logic" title="Direct link to heading">​</a></h3><p><code>build-logic</code> - <a href="/learning/gradle/composite-build">композитный</a> проект. Он предназначен для реализации логики сборки, не привязанной к конкретному gradle модулю.</p><p>В этой директории можно увидеть собственный <code>build.gradle.kts</code> и исходный код библиотеки. <code>build.gradle.kts</code> определяет как будет собираться данная библиотека и какие зависимости ей требуются. Исходный код библиотеки в нашем композитном билде содержит <a href="/learning/gradle/convention-plugins">convention plugins</a>, нужные для сборки основного Gradle проекта.</p><p>Внутри <code>build.gradle.kts</code> объявлены нужные зависимости:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api(&quot;dev.icerock:mobile-multiplatform:0.12.0&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.5.21&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api(&quot;com.android.tools.build:gradle:4.2.1&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api(&quot;io.gitlab.arturbosch.detekt:detekt-gradle-plugin:1.15.0&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Он подключается внутри файла <code>settings.gradle.kts</code> командой:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">includeBuild(&quot;build-logic&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="gradleproperties">gradle.properties<a class="hash-link" href="#gradleproperties" title="Direct link to heading">​</a></h3><p>Это файл с параметрами Gradle проекта:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">org.gradle.jvmargs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">-Xmx4096m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">org.gradle.configureondemand</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">org.gradle.parallel</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">org.gradle.caching</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kotlin.code.style</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">official</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">android.useAndroidX</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kotlin.mpp.stability.nowarn</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mobile.multiplatform.iosTargetWarning</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VERSION_NAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VERSION_CODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">xcodeproj</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ios-app/ios-app.xcworkspace</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Более подробней о параметрах Gradle вы можете прочитать в <a href="/learning/gradle/build-environment">разделе обучения</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="settingsgradlekts">settings.gradle.kts<a class="hash-link" href="#settingsgradlekts" title="Direct link to heading">​</a></h3><p>Этот файл определяет настройки gradle проекта. здесь мы можем подключать под-проекты (вызовом include) и подключать другие gradle проекты, настраивая composite build (вызовом includeBuild)&quot;</p><p>В нашем случае это <code>build-logic</code> (composite build), <code>android-app</code>, <code>mpp-library</code> и <code>mpp-library:feature:auth</code> (sub-projects).</p><p>Исходный код:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение фичи каталога версий (появилась с Gradle 7.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enableFeaturePreview(&quot;VERSION_CATALOGS&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// включение фичи для быстрого доступа к стукруте проекта (появилась с Gradle 7.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enableFeaturePreview(&quot;TYPESAFE_PROJECT_ACCESSORS&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencyResolutionManagement {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // репозитории, из которых будут загружаться зависимости проекта</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repositories {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mavenCentral()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        google()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        jcenter {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            content {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                includeGroup(&quot;org.jetbrains.kotlinx&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// В настройках тоже можно подключать плагины.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Данный плагин является настройкой плагина Gradle Talaiot.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Он отправляет статистику сборки в аналитическую базу данных Influx</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// нашей компании.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plugins {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.gradle.talaiot&quot;) version(&quot;3.+&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение composite-build</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">includeBuild(&quot;build-logic&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение подпроектов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">include(&quot;:android-app&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">include(&quot;:mpp-library&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">include(&quot;:mpp-library:feature:auth&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Именно <code>settings.gradle.kts</code> иллюстрирует многомодульность нашего основного проекта.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="buildgradlekts">build.gradle.kts<a class="hash-link" href="#buildgradlekts" title="Direct link to heading">​</a></h3><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">buildscript {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // репозитории, из которых будут загружаться плагины проекта</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repositories {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mavenCentral()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        google()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        gradlePluginPortal()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // добавление зависимостей в выполнение gradle скриптов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.mokoResourcesGeneratorGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.mokoNetworkGeneratorGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.mokoUnitsGeneratorGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.kotlinSerializationGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.hiltGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.firebaseCrashlyticsGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(libs.googleServicesGradle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classpath(&quot;:build-logic&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">allprojects {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // принудительно использовать coroutines-native-mt версию ( необходима для многопоточности )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    configurations.configureEach {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        resolutionStrategy {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            val coroutines: MinimalExternalModuleDependency = rootProject.libs.coroutines.get()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            val forcedCoroutines: ModuleVersionSelector = DefaultModuleVersionSelector.newSelector(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                coroutines.module,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                coroutines.versionConstraint.requiredVersion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            force(forcedCoroutines)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// таска на очистку билдов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tasks.register(&quot;clean&quot;, Delete::class).configure {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group = &quot;build&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    delete(rootProject.buildDir)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Подробнее о конфигурациях зависимостей вы можете прочитать в <a href="/learning/gradle/configuration">разделе обучения</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="mpp-library">mpp-library<a class="hash-link" href="#mpp-library" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="mpp library folder" src="/assets/images/project-inside-mpp-lib-7e4532ea19d42811650bbf98e05d4e2c.png" width="930" height="612" class="img_E7b_"></p><p>Оба приложения зависят от mpp-library, которая предоставляет доступ к ViewModel’и каждой фичи через SharedFactory.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="buildgradlekts-1">build.gradle.kts<a class="hash-link" href="#buildgradlekts-1" title="Direct link to heading">​</a></h3><p>Тут объявляются все зависимости и конфигурации нашей общей библиотеки. Давайте посмотрим что внутри.</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение плагинов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plugins {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // convention-плагин, в котором происходит подключение adnroid плагина,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // kotlin multiplatform плагина и устанавливаются таргеты ios и android</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;multiplatform-library-convention&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // convention-плагин, в котором происходит подключение detekt плагина</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // и его настройка</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;detekt-convention&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // плагин для обеспечения доступа к ресурсам на iOS и Android</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подробнее тут https://github.com/icerockdev/moko-resources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.mobile.multiplatform-resources&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // плагин настройки задач синхронизации групповых Cocoa-pod&#x27;ов </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // для корректной их интеграции</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подробнее тут https://github.com/icerockdev/mobile-multiplatform-gradle-plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.mobile.multiplatform.ios-framework&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // плагином для генерации сущностей и классов API </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // из файла спецификаций OpenAPI (Swagger)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подробнее тут https://github.com/icerockdev/moko-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.mobile.multiplatform-network-generator&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // плагин компилятора, который позволяет сериализовывать документ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // предоставляю к нему доступ с разных платформ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;kotlinx-serialization&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Kotlin Parcelize plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Добавляет аннотоцию @Parcelize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;kotlin-parcelize&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // плагин для настройки взаимодействия с CocoaPods</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // указание пути до файла проекта </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // а также позволяет управлять управлять cocoa-зависимостями</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подробнее тут https://github.com/icerockdev/mobile-multiplatform-gradle-plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.mobile.multiplatform.cocoapods&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// объявление зависимостей</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.coroutines)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.kotlinSerialization)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.ktorClient)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.ktorClientLogging)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    androidMainImplementation(libs.multidex)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    androidMainImplementation(libs.lifecycleViewModel)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(projects.mppLibrary.feature.auth)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.multiplatformSettings)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.napier)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoParcelize)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoResources)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoMvvmCore)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoMvvmLiveData)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoMvvmState)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoUnits)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoFields)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoNetwork)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoErrors)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoNetworkErrors)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoCrashReportingCore)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoCrashReportingCrashlytics)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainApi(libs.mokoCrashReportingNapier)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonTestImplementation(libs.mokoTestCore)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonTestImplementation(libs.mokoMvvmTest)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonTestImplementation(libs.mokoUnitsTest)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonTestImplementation(libs.multiplatformSettingsTest)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonTestImplementation(libs.ktorClientMock)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// идентификатор пакета ресурсов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multiplatformResources {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    multiplatformResourcesPackage = &quot;org.example.library&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">framework {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // экспорты фичей в iOS фреймворк</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(projects.mppLibrary.feature.auth)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // экспорт либ в iOS фреймворк</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.multiplatformSettings)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.napier)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoParcelize)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoResources)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoMvvmCore)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoMvvmLiveData)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoMvvmState)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoUnits)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoFields)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoNetwork)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoErrors)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoNetworkErrors)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoCrashReportingCore)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoCrashReportingCrashlytics)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    export(libs.mokoCrashReportingNapier)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cocoaPods {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // путь до проекта</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    podsProject = file(&quot;../ios-app/Pods/Pods.xcodeproj&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подключение нативного pod внутри kotlin кода</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pod(&quot;MCRCDynamicProxy&quot;, onlyLink = true)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// mokoNetwork</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение yml файла для генерации api</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подробнее тут https://github.com/icerockdev/moko-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mokoNetwork {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    spec(&quot;news&quot;) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        inputSpec = file(&quot;src/api/openapi.yml&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>О том, как происходят экспорты зависимостей в iOS-фреймворк, написано в  <a href="https://kotlinlang.org/docs/mpp-build-native-binaries.html#export-dependencies-to-binaries" target="_blank" rel="noopener noreferrer">соответсвующей статье</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="multiplatformlibrarypodscpec">MultiplatformLibrary.podscpec<a class="hash-link" href="#multiplatformlibrarypodscpec" title="Direct link to heading">​</a></h3><p>Более подробно об этом файле вы можете прочитать <a href="/learning/ios/pods#podspec">тут</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="src">src<a class="hash-link" href="#src" title="Direct link to heading">​</a></h3><p>В папке <code>srс</code> находится исходный код общей библиотеки.</p><p><img loading="lazy" alt="mpp-library-" src="/assets/images/project-inside-mpp-lib-src-6091f8bd0a58c1d8f19bee5b5bd8ec6b.png" width="724" height="484" class="img_E7b_"></p><ul><li><code>androidMain</code> - директория, содержащая файл <code>AndroidManifest.xml</code>, в котором объявляется идентификатор (уникальный!) для модуля <code>mpp-library</code> для Android-приложения;</li><li><code>api</code> - директория, содержащая файл для генерации методов взаимодействия с API;</li><li>директория <code>commonMain</code> содержит директорию <code>kotlin</code>, в которой как раз и пишется вся бизнес-логика приложения; в директории <code>resources</code> находятся ресурсы, попавшие в проект через <a href="https://github.com/icerockdev/moko-resources" target="_blank" rel="noopener noreferrer">moko-resources</a>;</li><li><code>commonTest</code> - директория, в которой находится исходный код тестов для общей библиотеки;</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="features">feature&#x27;s<a class="hash-link" href="#features" title="Direct link to heading">​</a></h3><p>Как мы видим mpp-library содержит в себе подпроект feature.
Каждая фича в котором является Gradle-библиоткой, несущей в себе набор соответствующих моделей, view-моделей, фабрик и интерфейсов, которые ожидаются от родительского модуля. </p><p><img loading="lazy" alt="mpp-library-one-feature" src="/assets/images/project-inside-mpp-lib-feature-80c983f7a8bc2cb95ce9845a67b1c1d7.png" width="704" height="480" class="img_E7b_"></p><p>Каждая фича имеет однотипную структуру. Внутри <code>commonMain/kotlin/…</code> обычно находятся директории:</p><ul><li><code>di</code> - директория, содержащая фабрику для создания View-моделей и все, что связано с инъекцией зависимостей;</li><li><code>model</code> - директория, содержащая все сущности (в основном data-классы и enum’ы) нужные в рамках данной view-модели, а также в которой определяются репозитории для хранения и взаимодействия с данными.</li><li><code>presentation</code> - директория, содержащая сами view-model&#x27;и и, возможно, фабрики юнитов (об этом поговорим дальше).</li></ul><p>Пример фичей:</p><ul><li>Auth</li><li>Settings</li><li>List
и т.п</li></ul><p>В файле <code>build.gradle.kts</code>, который находится в директории каждой фичи указаны все зависимости, нужные для данной фичи.</p><p>Посмотрим: </p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// подключение плагинов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plugins {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;detekt-convention&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;multiplatform-library-convention&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// объявление зависимостей</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.coroutines)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    androidMainImplementation(libs.lifecycleViewModel)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // moko-mvvm &amp; moko-resources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.mokoMvvmLiveData)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commonMainImplementation(libs.mokoResources)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Т.к каждая фича является отдельной Gradle-библиотекой, то она обязана содержать файл <code>AndroidManifest.xml</code>, в котором объявляется уникальное имя для класса Android-приложения.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Во всем проекте каждый <code>AndroidManifest</code> должен иметь уникальный идентификатор, который использует Android приложение для генерации специальных классов. </p><p>При коллизии идентификаторов получится несколько одинаковых классов!</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="shared--domain-factory">Shared &amp; Domain Factory<a class="hash-link" href="#shared--domain-factory" title="Direct link to heading">​</a></h3><blockquote><p>Чтобы понять, что такое <em>Shared</em> и <em>Domain</em> Factory, нужно будет немного разобраться с подходом разделения ответственности и проброса необходимых зависимостей в проектах.</p></blockquote><p>Мы стараемся делать фичи максимально независящими от контекста проекта. Иными словами — фича должна знать ровно тот набор информации, который ей нужен для корректной работы в рамках самой себя. При этом важно сократить до минимума её зависимости от каких либо других модулей. Делается это для ускорения сборки проекта. Наиболее критично такое сказывается на времени компиляции под iOS, когда проект уже разросся. Например, если 3 разных фичи имеют зависимость на какой-то один общий вспомогательный модуль, назовём его shared, то при любом изменении shared мы получим полную пересборку всех этих трёх модулей при сборке под iOS, в то время как на Android такого не будет.
Поэтому мы стремимся делать фичи полностью независимыми, кроме тех, которые меняются крайне редко!</p><blockquote><p>А как быть тогда с моделями, общими для всего проекта?
Как устроить работу с сетью, ведь она же должна быть общей для разных фичей?
Как использовать вспомогательные расширения, они же могут быть общие для разных фичей?</p></blockquote><p>Сейчас постараемся ответить на эти вопросы.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="как-было-раньше">Как было раньше?<a class="hash-link" href="#как-было-раньше" title="Direct link to heading">​</a></h4><p>У нас были такие модули как <em>domain</em> и <em>shared</em>, а также фабрики <em>DomainFactory</em> и <em>SharedFactory</em>.</p><p><img loading="lazy" alt="project-inside-shared-domain" src="/assets/images/project-inside-shared-domain-5e5f433e2b848e3c081ea4b24e404a27.png" width="624" height="404" class="img_E7b_"></p><p>Модуль <em>domain</em> включал в себя описания доменных сущностей, описание классов для работы с сервером, логику преобразования серверных ответов в те самые доменные сущности, с которыми могло работать приложение. Также в нём содержалась и доменная фабрика <em>DomainFactory</em>, которая создавала классы для работы с сетью, репозитории, управляющие данными и производила настройку http-клиента. А также именно расширениями к <em>DomainFactory</em> реализовывались создания всех остальных фабрик для фичей.</p><p><img loading="lazy" alt="domain-module" src="/assets/images/project-inside-domain-687d43639020adb1e25e405de6b6ddd7.png" width="682" height="846" class="img_E7b_"></p><p>Модуль <em>shared</em> содержал большое количество полезных расширений, вспомогательных методов, упрощений и прочих переиспользуемых между модулями вещей.</p><p>А внутри модуля <em>mpp-library</em> располагалась и <em>SharedFactory</em> (либо просто <em>Factory</em>, на разных старых проектах название может быть разным). Её предназначение было получить с натива все данные, необходимые для реализации <em>DomainFactory</em> и, соответственно, <em>DomainFactory</em> на основе этих же данных могла реализовывать свои внутренние компоненты. Плюс <em>mpp-library</em> служила прослойкой для маппинга всех доменных сущностей в сущности фичей. Например, модель юзера могла быть и в модуле авторизации и в модуле профилей. Но auth:User и profile:User - это были разные модели и преобразование от доменной сущности domain:User (который мы получали после преобразования ответа сервера) требовалось для каждой из них.</p><p><img loading="lazy" alt="shared-and-src" src="/assets/images/project-inside-shared-src-c18d4ddb543f856e3a18e0caffc73652.png" width="754" height="890" class="img_E7b_"></p><p>И чтобы в фичах мы могли спокойно кидать запросы, использовать модели данных и применять вспомогательные методы из <em>shared</em>, приходилось добавлять практически во всех фичах зависимости на <em>shared</em>.</p><blockquote><p>По началу всё шло неплохо. Производительность не сильно страдала. Проблемы начались тогда, когда мы имеем уже объёмный проект, состоящий из 10-15 модулей с фичами. И в какой-то момент нам для одной из фичей надо в <em>shared</em> добавить небольшой код или поправить реализацию уже имеющегося. Это приводило к тому, что на iOS начинают пересобираться абсолютно все зависящие на shared модули, а разработчик, поменявший одну строчку, мог ждать сборки iOS по 10 с лишним минут.</p></blockquote><blockquote><p>И вторая большая проблема заключалась в том, что мы вынуждены были плодить множество сущностей. На примере всё того же юзера у нас была сетевая сущность юзера, которую присылал бэк, доменная сущность юзера, в которую мы преобразовывали сетевую, а далее для фичей авторизации и профиля — ещё по одной сущности, которые относятся уже к самим фичам, а они, в свою очередь, должны преобразовываться из доменных. Самый банальный пример — если на сервере добавляют новое поле в сущности, которое нам нужно использовать, то его приходилось пробрасывать через все эти круги ада и тратить время.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="к-чему-мы-пришли">К чему мы пришли?<a class="hash-link" href="#к-чему-мы-пришли" title="Direct link to heading">​</a></h4><p>Из-за всего вышесказанного, от данного подхода было принято отказываться в сторону более нового - с учётом независимости фичи и проброса в неё внешних зависимостей.</p><blockquote><p>Если в рамках работы над проектом вам встречается модуль <em>domain</em>, <em>shared</em> или <em>DomainFactory</em>, то это проект, построенный на старом варианте архитектуры.</p><p>Этот подход не актуален!</p><p> В рамках поддержки существующих фичей, при невозможности изменения добавления зависимости от модуля на проброс зависимостей через интерфейсы, придётся использовать старый способ.
При создании же новых фичей, даже с учётом старой архитектуры в этом проекте, их нужно реализовывать актуальным способом.</p></blockquote><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>На текущий момент наиболее актуальным архитектурным подходом является тот, что представлен в рамках boilerplate-проекта, с которого мы начали разработку.</p></div></div><p><strong>Что изменилось:</strong></p><ul><li><p>Модуль <em>domain</em> упразднён! </p><p>Сущность и модели у каждой фичи свои, в рамках модуля этой фичи. И они содержат достаточный набор данных для её работы. Но в случаях, когда одни и те же сущности должны использоваться между несколькими фичами, для того, чтобы избежать дублирования, такие сущности выносятся в отдельный модуль и в зависимость добавляется именно он.</p></li><li><p><em>DomainFactory</em> упразднена. </p><p>Её роль забирает <em>SharedFactory</em>, которая доступна с натива и находится в <em>mpp-library</em>. Через неё же можно с нативной стороны достучаться до всех необходимых фабрик фичей. Фабрики фичей всё также реализовываются как расширения, но уже к <em>SharedFactory</em>, а не к <em>DomainFactory</em>. Инициализация классов работы с API также происходит в SharedFactory.</p></li><li><p>Модуль <em>shared</em> упразднён.</p><p>Подобные общие компоненты реализовываются внутри модуля <em>mpp-library</em>.</p></li><li><p>Для реализации логики работы с данными, либо с сервером используются репозитории. Каждая ViewModel описывает у себя интерфейс репозитория, покрывающий её нужды. Либо бывают случаи общего интерфейса репозитория на несколько ViewModel, но в рамках одной фичи. Реализация этого репозитория должна передаваться при создании ViewModel. Сами реализации создаются в модуле <em>mpp-library</em>, а он, как мы знаем, имеет информацию и о view-моделях (т.к. <em>mpp-library</em> знает о других модулях) и о сетевом слое. Соответственно в его рамках без проблем можно описать реализации этих интерфейсов и пробросить их в фабрику фичи, которая, в свою очередь, передаст реализацию во ViewModel. Это же помогает избежать пачки мапперов из сетевой сущности в доменную, из доменной в фичёвую.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="структура-проекта-1">Структура проекта<a class="hash-link" href="#структура-проекта-1" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="classes arch" src="/assets/images/project-inside-clases-dependency-b8b3c547abf29cd4b205811b82134b99.png" width="1028" height="912" class="img_E7b_"></p><p>На этой схеме показана структура проекта:</p><p>У нас есть два приложения, которые представляют уровень приложений:</p><ul><li>android-приложение, написанное на Kotlin</li><li>ios-приложение, написанное на Swift,</li></ul><p>Оба приложения зависят от mpp-library, которая обеспечивает доступ к ViewModel каждой фичи через SharedFactory.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="android-app">android-app<a class="hash-link" href="#android-app" title="Direct link to heading">​</a></h2><p><code>android-app</code> - Gradle проект с Android-приложением.</p><p><img loading="lazy" alt="android-app" src="/assets/images/project-inside-android-app-structure-c66212d274643bebbf9183087c208e3d.png" width="740" height="758" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="buildgradlekts-2">build.gradle.kts<a class="hash-link" href="#buildgradlekts-2" title="Direct link to heading">​</a></h3><p>В корне данного проекта находится свой <code>build.gradle.kts</code> файл:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plugins {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подключение convention-плагина</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // в котором как раз и поключается android plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // &quot;com.android.application&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // и настраивается buildTypes и productFlavors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;android-app-convention&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подключение оброботчика аннотаций kapt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;kotlin-kapt&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // подключение плагина moko-units</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dev.icerock.mobile.multiplatform-units&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Плагин для инъекции зависимостей в Android приложении</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id(&quot;dagger.hilt.android.plugin&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// конфигурация android приложения</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">android {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // включение фичи dataBinding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    buildFeatures.dataBinding = true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // параметры для генерации BuildConfig файла</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    defaultConfig {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // идентификатор для приложения</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        applicationId = &quot;org.example.app&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // указание версий</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        versionCode = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        versionName = &quot;0.1.0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // API URL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        val url = &quot;https://newsapi.org/v2/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        buildConfigField(&quot;String&quot;, &quot;BASE_URL&quot;, &quot;\&quot;$url\&quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// настройки kapt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kapt {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    javacOptions {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // These options are normally set automatically via the Hilt Gradle plugin, but we</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // set them manually to workaround a bug in the Kotlin 1.5.20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        option(&quot;-Adagger.fastInit=ENABLED&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        option(&quot;-Adagger.hilt.android.internal.disableAndroidSuperclassValidation=true&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// объявление зависимостей android приложения</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.appCompat)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.material)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.recyclerView)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.swipeRefreshLayout)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.mokoMvvmDataBinding)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Hilt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(libs.hilt)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kapt(libs.hiltCompiler)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    implementation(projects.mppLibrary)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// настройка юнитов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multiplatformUnits {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    classesPackage = &quot;org.example.app&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataBindingPackage = &quot;org.example.app&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    layoutsSourceSet = &quot;main&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="устройство-проекта">Устройство проекта<a class="hash-link" href="#устройство-проекта" title="Direct link to heading">​</a></h3><p>Теперь разберем, что лежит в директории<code>src/main</code>:</p><ul><li><code>java/org.example.app</code> - содержит исходный код нашего приложения:<ul><li>директория <code>di</code> содержит в себе объекты, связанные с инъекцией зависимостей через Hilt;</li><li>директория <code>view</code> содержит классы всех UI элементов;</li><li><code>MainApplication</code> - входная точка Android приложения;</li></ul></li><li><code>res</code> - директория со всеми ресурсами, необходимыми android приложению;</li><li><code>ic_launcher-playstore.png</code> - иконка приложения; она автоматически размещается Android SDK, чтобы вы не забыли создать значок в высоком разрешении для публикации;</li><li><code>AndroidManifest.xml</code> - файл манифеста, содержащий важную информацию о вашем приложении для инструментов сборки Android, операционной системы Android и Google Play. Более подробно о файле манифеста вы можетепрочитать <a href="https://developer.android.com/guide/topics/manifest/manifest-intro" target="_blank" rel="noopener noreferrer">тут</a>;</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="hilt-di">Hilt DI<a class="hash-link" href="#hilt-di" title="Direct link to heading">​</a></h3><p>Инициализация <code>SharedFactory</code> из нашей <code>mpp-library</code> происходит в Hilt модуле <code>FactoriesModule.kt</code>.</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    di/FactoriesModule.kt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// imports ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@InstallIn(ActivityComponent::class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Module</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object FactoriesModule {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Provides</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fun authNewFactory(sharedFactory: SharedFactory): AuthFactory =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sharedFactory.authFactory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>О том, что мы используем инъекцию зависимостей при помощи Hilt говорит аннотация <code>@HiltAndroidApp</code> в <code>MainApplication.kt</code>:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MainApplication.kt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HiltAndroidApp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class MainApplication : Application() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    override fun onCreate() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        super.onCreate()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FirebaseApp.initializeApp(this)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FirebaseCrashlytics.getInstance()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .setCrashlyticsCollectionEnabled(BuildConfig.DEBUG.not())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Узнать больше про инъекцию зависимостей в Android приложении при помощи Hilt вы можете <a href="https://developer.android.com/training/dependency-injection/hilt-android" target="_blank" rel="noopener noreferrer">тут</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="навигация-в-android">Навигация в Android<a class="hash-link" href="#навигация-в-android" title="Direct link to heading">​</a></h3><p>Для того, чтобы понять как устроена навигация в Android приложении можете ознакомиться с соответствующей статьей в <a href="/learning/android/navigation">разделе обучения</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ios-app">ios-app<a class="hash-link" href="#ios-app" title="Direct link to heading">​</a></h2><p><code>ios-app</code> - директория, в которой лежит Xcode проект iOS приложения.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="устройство-проекта-1">Устройство проекта<a class="hash-link" href="#устройство-проекта-1" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="ios-app-dirs" src="/assets/images/project-inside-ios-app-a35961ad79490b70c93741cb049c8bd1.png" width="688" height="1434" class="img_E7b_"></p><p>Как мы видим, к iOS проекту подключена директория <code>mpp-library</code> - это наша общая бизнес логика.
В директории <code>src</code> находится исходные код нашего приложения:</p><ul><li><code>Firebase</code> - директория с plist файлом для настройки сервисов Firebase;</li><li><code>Extensions</code> - директория с расширениями классов;</li><li><code>Common</code> - директория с общими UI/Logic элементами для всего iOS приложения;</li><li><code>Resources</code> - директория с ресурсами (например, R.swift и прочее);</li><li><code>Feature</code> - директория с фичами (еще не создана);</li></ul><p>В директории <code>BuildConfigurations</code> лежат файлы конфигурации сборки проекта, подробнее о них вы можете прочитать <a href="/learning/ios/configuration">тут</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="входная-точка-приложения">Входная точка приложения<a class="hash-link" href="#входная-точка-приложения" title="Direct link to heading">​</a></h3><p>Посмотрим на файл <code>AppDelegate.swift</code>:</p><div class="language-swift codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-swift codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// импорт UI библиотеки</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import UIKit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// импорт нашей мультиплатформенной библиотеки</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import MultiPlatformLibrary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// импорт внешних зависимостей</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import MCRCStaticReporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import FirebaseCore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@UIApplicationMain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class AppDelegate: NSObject, UIApplicationDelegate {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // создание окна приложения</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var window: UIWindow?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // переменная координатора</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private (set) var coordinator: AppCoordinator!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    func application(_ application: UIApplication, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]? = nil) -&gt; Bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // настройка сервисов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FirebaseApp.configure()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        MokoFirebaseCrashlytics.setup()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Инициализация нашей SharedFactory, через синглтон AppComponent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        AppComponent.factory = SharedFactory(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            settings: AppleSettings(delegate: UserDefaults.standard),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            antilog: DebugAntilog(defaultTag: &quot;MPP&quot;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            baseUrl: &quot;https://newsapi.org/v2/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // работа с координатором, об этом чуть позже</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        coordinator = AppCoordinator.init(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            window: self.window!,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            factory: AppComponent.factory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        coordinator.start()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Файл <code>AppComponent.swift</code>:</p><div class="language-swift codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-swift codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import Foundation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import MultiPlatformLibrary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class AppComponent {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    static var factory: SharedFactory!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Класс AppDelegate является стартовой точкой приложения, это можно понять по атрибуту <code>@UIApplicationMain</code> перед классом. Именно в нем происходит настройка всех сторонних сервисов и создание экземпляра нашей SharedFactory, для последующего доступа к фабрикам фичей.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="навигация-в-ios">Навигация в iOS<a class="hash-link" href="#навигация-в-ios" title="Direct link to heading">​</a></h3><p>Мы поняли что является отправной точкой нашего приложения, а теперь нам нужно понять как построена навигация в iOS приложение и какие подходы при работе с ней мы используем.</p><p>Для этого можете ознакомиться со <a href="/learning/ios/navigation">статьей в разделе обучения</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="mastersh">master.sh<a class="hash-link" href="#mastersh" title="Direct link to heading">​</a></h2><p>В корне проекта находится скрипт <code>master.sh</code>, содержащий в себе вспомогательный функционал.</p><p>Этот скрипт нужно запускать с конкретным параметром:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./master.sh </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">param</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Параметры:</p><ul><li><code>help</code> - выводит информацию о скрипте</li><li><code>clean_ide</code> - чистит файлы IDE</li><li><code>localize</code> - генерация локализованных строк, о которой вы можете прочитать <a href="/onboarding/generate-localized-strings">тут</a>.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/icerockdev/kmm.icerock.dev/tree/docusaurus/onboarding/project-inside.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/onboarding/project-setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Запуск проекта</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/onboarding/gradle"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Gradle</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#вводная" class="table-of-contents__link toc-highlight">Вводная</a></li><li><a href="#конфигурация-сборки" class="table-of-contents__link toc-highlight">Конфигурация сборки</a><ul><li><a href="#сборка-android-приложения" class="table-of-contents__link toc-highlight">Сборка Android приложения</a></li><li><a href="#сборка-ios-приложения" class="table-of-contents__link toc-highlight">Сборка iOS приложения</a></li></ul></li><li><a href="#структура-проекта" class="table-of-contents__link toc-highlight">Структура проекта</a></li><li><a href="#root-gradle-project" class="table-of-contents__link toc-highlight">Root Gradle project</a><ul><li><a href="#buildsrc-устарело-но-бывает-на-проектах" class="table-of-contents__link toc-highlight">buildSrc (устарело, но бывает на проектах)</a></li><li><a href="#version-catalogs" class="table-of-contents__link toc-highlight">Version Catalogs</a></li><li><a href="#build-logic" class="table-of-contents__link toc-highlight">build-logic</a></li><li><a href="#gradleproperties" class="table-of-contents__link toc-highlight">gradle.properties</a></li><li><a href="#settingsgradlekts" class="table-of-contents__link toc-highlight">settings.gradle.kts</a></li><li><a href="#buildgradlekts" class="table-of-contents__link toc-highlight">build.gradle.kts</a></li></ul></li><li><a href="#mpp-library" class="table-of-contents__link toc-highlight">mpp-library</a><ul><li><a href="#buildgradlekts-1" class="table-of-contents__link toc-highlight">build.gradle.kts</a></li><li><a href="#multiplatformlibrarypodscpec" class="table-of-contents__link toc-highlight">MultiplatformLibrary.podscpec</a></li><li><a href="#src" class="table-of-contents__link toc-highlight">src</a></li><li><a href="#features" class="table-of-contents__link toc-highlight">feature&#39;s</a></li><li><a href="#shared--domain-factory" class="table-of-contents__link toc-highlight">Shared &amp; Domain Factory</a></li><li><a href="#структура-проекта-1" class="table-of-contents__link toc-highlight">Структура проекта</a></li></ul></li><li><a href="#android-app" class="table-of-contents__link toc-highlight">android-app</a><ul><li><a href="#buildgradlekts-2" class="table-of-contents__link toc-highlight">build.gradle.kts</a></li><li><a href="#устройство-проекта" class="table-of-contents__link toc-highlight">Устройство проекта</a></li><li><a href="#hilt-di" class="table-of-contents__link toc-highlight">Hilt DI</a></li><li><a href="#навигация-в-android" class="table-of-contents__link toc-highlight">Навигация в Android</a></li></ul></li><li><a href="#ios-app" class="table-of-contents__link toc-highlight">ios-app</a><ul><li><a href="#устройство-проекта-1" class="table-of-contents__link toc-highlight">Устройство проекта</a></li><li><a href="#входная-точка-приложения" class="table-of-contents__link toc-highlight">Входная точка приложения</a></li><li><a href="#навигация-в-ios" class="table-of-contents__link toc-highlight">Навигация в iOS</a></li></ul></li><li><a href="#mastersh" class="table-of-contents__link toc-highlight">master.sh</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">IceRock Development</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Site</a></li><li class="footer__item"><a href="https://github.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://www.facebook.com/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://vk.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">VK</a></li><li class="footer__item"><a href="https://www.instagram.com/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC-Vhmm09W_IWKHhSg80d68w" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li><li class="footer__item"><a href="https://twitter.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter @icerockdev<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/kotlinmpp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram @kotlinmpp<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/kotlinmppchats" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram @kotlinmppchats<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kotlinlang.org/lp/mobile" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Mobile<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://libs.kmp.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Libs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://codelabs.kmp.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Codelabs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://moko.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">MOKO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/docs/reference/native-overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin/Native Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/docs/reference/multiplatform.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 IceRock Development. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a0e172f5.js"></script>
<script src="/assets/js/main.c6cd5e7a.js"></script>
</body>
</html>